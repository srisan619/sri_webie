<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">   

    <h2>User List</h2>
    {% if request.user.role.role_name == "admin" %}
        <a href="/users/create/">Create</a>
    {% endif %}
</head>
<body>
    {% if messages %}
        {%for message in messages%}
            <div class="alert alert-{{message.tags}} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {%endfor%}
    {%endif%}
    <table border="1">
        <tr>
            <th>Username</th>
            <th>Email</th>
            <th>Role</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>

        {% for u in users %}
        <tr>
            <td>{{u.username}}</td>
            <td>{{u.email}}</td>
            <td>{{u.role}}</td>
            <td>{% if u.is_active%} <span class="badge bg-success">Active</span> {%else%} <span class="badge bg-secondary">InActive</span> {%endif%}</td>
            <td class="text-center">
                {% if request.user.role.role_name == "admin" %}
                    <a href="/users/{{u.id}}/edit/" class="btn btn-sm btn-warning"><i class="bi bi-pencil-square"></i></a>
                    <!-- <a href="/users/{{u.id}}/delete/">Delete</a> -->
                    {% if u.is_active %}
                        <a href="/users/{{u.id}}/toggle-status" class="btn btn-sm btn-success" title="Deactivate user"><i class="bi bi-toggle-on"></i></a>
                    {%else%}
                        <a href="/users/{{u.id}}/toggle-status" class="btn btn-sm btn-danger" title="Activate user"><i class="bi bi-toggle-off"></i></a>
                    {% endif %}
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>